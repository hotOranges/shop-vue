{"version":3,"sources":["webpack:///src/components/im/ChatHistory.vue","webpack:///./src/components/im/ChatHistory.vue?2f61","webpack:///./src/components/im/ChatHistory.vue","webpack:///./src/components/im/configs/emoji.js","webpack:///src/components/im/components/ChatItem.vue","webpack:///./src/components/im/components/ChatItem.vue?d7b8","webpack:///src/components/im/components/ChatList.vue","webpack:///./src/components/im/components/ChatItem.vue","webpack:///./src/components/im/components/ChatList.vue?3084","webpack:///./src/components/im/components/ChatList.vue"],"names":["ChatHistory","mounted","this","$store","dispatch","getHistoryMsgs","updated","tempPagePos","page","getChatListHeight","scrollChatListDown","currPagePos","components","ChatList","data","leftBtnOptions","backText","preventGoBack","computed","sessionId","$route","params","sessionName","user","test","replace","state","userUID","userInfo","userInfos","utils","getFriendAlias","myInfo","msglist","currSessionMsgs","scene","parseSession","to","canLoadMore","noMoreHistoryMsgs","methods","loadMore","getChatListScroll","onClickBack","window","history","go","im_ChatHistory","render","_h","$createElement","_c","_self","staticClass","attrs","title","left-arrow","on","click-left","_v","staticStyle","height","ref","type","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","emojiBaseUrl","emojiList","emoji","[大笑]","file","[可爱]","[色]","[嘘]","[亲]","[呆]","[口水]","[汗]","[呲牙]","[鬼脸]","[害羞]","[偷笑]","[调皮]","[可怜]","[敲]","[惊讶]","[流感]","[委屈]","[流泪]","[嚎哭]","[惊恐]","[怒]","[酷]","[不说]","[鄙视]","[阿弥陀佛]","[奸笑]","[睡着]","[口罩]","[努力]","[抠鼻孔]","[疑问]","[怒骂]","[晕]","[呕吐]","[拜一拜]","[惊喜]","[流汗]","[卖萌]","[默契眨眼]","[烧香拜佛]","[晚安]","[强]","[弱]","[OK]","[拳头]","[胜利]","[鼓掌]","[握手]","[发怒]","[骷髅]","[便便]","[火]","[溜]","[爱心]","[心碎]","[钟情]","[唇]","[戒指]","[钻石]","[太阳]","[有时晴]","[多云]","[雷]","[雨]","[雪花]","[爱人]","[帽子]","[皇冠]","[篮球]","[足球]","[垒球]","[网球]","[台球]","[咖啡]","[啤酒]","[干杯]","[柠檬汁]","[餐具]","[汉堡]","[鸡腿]","[面条]","[冰淇淋]","[沙冰]","[生日蛋糕]","[蛋糕]","[糖果]","[葡萄]","[西瓜]","[光碟]","[手机]","[电话]","[电视]","[声音开启]","[声音关闭]","[铃铛]","[锁头]","[放大镜]","[灯泡]","[锤头]","[烟]","[炸弹]","[枪]","[刀]","[药]","[打针]","[钱袋]","[钞票]","[银行卡]","[手柄]","[麻将]","[调色板]","[电影]","[麦克风]","[耳机]","[音乐]","[吉他]","[火箭]","[飞机]","[火车]","[公交]","[轿车]","[出租车]","[警车]","[自行车]","emojiItem","key","item","img","pinupList","ajmd","xxy","lt","i","ChatItem","props","String","rawMsg","Object","default","msg","isFullImgShow","currentAudio","beforeMount","assign_default","flow","from","avatar","link","showTime","formatDate","time","showText","text","escape","match","forEach","emojiCnt","content","JSON","parse","resourceUrl","configs","imgUrl","value","_data","catalog","chartlet","parseCustomMsg","originLink","url","audioSrc","mp3Url","Math","round","dur","fileLink","name","generateChatroomSysMsg","tip","mapMsgType","_this","$nextTick","media","Image","src","className","ext","document","createElement","width","autoStart","preload","controls","aLink","href","target","innerHTML","video","$refs","mediaMsg","appendChild","onload","$emit","onerror","revocateMsg","vNode","currSessionId","that","$vux","confirm","show","onCancel","onConfirm","idClient","showFullImg","playAudio","_this2","Audio","play","onended","components_ChatItem","_vm","class","item-me","item-you","item-time","item-tip","session-chat","_s","_e","domProps","click","$event","stopPropagation","status","Boolean","Array","msgLoadedTimer","msgLoaded","clearTimeout","setTimeout","components_ChatList","padding-bottom","margin-top","id","_l","msg-loaded","ChatList_Component","ChatList_normalizeComponent"],"mappings":"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","file":"static/js/1.f3d7c606ebdc66823f04.js","sourcesContent":["<template>\n<div class=\"g-window\">\n   <van-nav-bar\n  class=\"init-header\"\n  title=\"历史消息\"\n  left-arrow\n  @click-left=\"onClickBack\"\n/>\n  <div class=\"g-inherit m-article p-chat-history\">\n    <!-- <Row class=\"b-b-1\">\n      <Col span=\"24\">\n      <div class=\"fz-20 w-100 h60\">\n        <span class=\"fl m-l-10\" @click=\"onClickBack\">\n          <Icon class=\"fz-20\" type=\"ios-arrow-back\"></Icon>\n        </span>\n        <span class=\"fr m-r-10\">{{sessionName}}</span>\n      </div>\n      </Col>\n    </Row> -->\n      <div class=\"m-chat-main init\" style=\"height: 700px\">\n        <chat-list\n        style=\"height: 700px\"\n          ref=\"chatlist\"\n          type=\"session\"\n          :canLoadMore=\"canLoadMore\"\n          :msglist=\"msglist\"\n          :userInfos=\"userInfos\"\n          :myInfo=\"myInfo\"\n        ></chat-list>\n      </div>\n  </div>\n  </div>\n</template>\n\n<script>\n  /*eslint-disable*/\n  import ChatList from './components/ChatList'\n  import util from './utils'\n  import pageUtil from './utils/page'\n\n  export default {\n  /*  beforeMount () {\n      if (this.$store.state.isRefresh) {\n        location.href = `/im_web/chat/${this.sessionId}`\n      }\n    },*/\n    mounted () {\n      this.$store.dispatch('resetNoMoreHistoryMsgs')\n      this.getHistoryMsgs()\n    },\n    updated () {\n      let tempPagePos = pageUtil.getChatListHeight()\n      pageUtil.scrollChatListDown(tempPagePos - this.currPagePos)\n      this.currPagePos = tempPagePos\n    },\n    components: {\n      ChatList\n    },\n    data () {\n      return {\n        leftBtnOptions: {\n          backText: ' ',\n          preventGoBack: true,\n        },\n        currPagePos: 0,\n        // selectedDate: ''\n      }\n    },\n    computed: {\n      sessionId () {\n        return this.$route.params.sessionId\n      },\n      sessionName () {\n        let sessionId = this.sessionId\n        let user = null\n        if (/^p2p-/.test(sessionId)) {\n          user = sessionId.replace(/^p2p-/, '')\n          if (user === this.$store.state.userUID) {\n            return '我的手机'\n          }\n          let userInfo = this.userInfos[user] || {}\n          return util.getFriendAlias(userInfo)\n        } else if (/^team-/.test(sessionId)) {\n          return '群'\n        }\n      },\n      myInfo () {\n        return this.$store.state.myInfo\n      },\n      userInfos () {\n        return this.$store.state.userInfos\n      },\n      msglist () {\n        let msgs = this.$store.state.currSessionMsgs\n        return msgs\n      },\n      scene () {\n        return util.parseSession(this.sessionId).scene\n      },\n      to () {\n        return util.parseSession(this.sessionId).to\n      },\n      canLoadMore () {\n        return !this.$store.state.noMoreHistoryMsgs\n      }\n    },\n    methods: {\n      getHistoryMsgs () {\n        if (this.canLoadMore) {\n          this.$store.dispatch('getHistoryMsgs', {\n            scene: this.scene,\n            to: this.to\n          })\n        }\n      },\n      loadMore () {\n        if (pageUtil.getChatListScroll() <= 5) {\n          this.getHistoryMsgs()\n        }\n      },\n      onClickBack: function () {\n        // location.href = `#/chat/${this.sessionId}`\n        window.history.go(-1)\n      }\n    }\n  }\n</script>\n\n<style type=\"scss\">\n  .p-chat-history {\n\n  .m-chat-main {\n    padding: 0;\n  }\n\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/im/ChatHistory.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"g-window\"},[_c('van-nav-bar',{staticClass:\"init-header\",attrs:{\"title\":\"历史消息\",\"left-arrow\":\"\"},on:{\"click-left\":_vm.onClickBack}}),_vm._v(\" \"),_c('div',{staticClass:\"g-inherit m-article p-chat-history\"},[_c('div',{staticClass:\"m-chat-main init\",staticStyle:{\"height\":\"700px\"}},[_c('chat-list',{ref:\"chatlist\",staticStyle:{\"height\":\"700px\"},attrs:{\"type\":\"session\",\"canLoadMore\":_vm.canLoadMore,\"msglist\":_vm.msglist,\"userInfos\":_vm.userInfos,\"myInfo\":_vm.myInfo}})],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-e81c88a6\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/im/ChatHistory.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-e81c88a6\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ChatHistory.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatHistory.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatHistory.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-e81c88a6\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./ChatHistory.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/im/ChatHistory.vue\n// module id = null\n// module chunks = ","/*eslint-disable*/\n\n/* 表情原图配置文件 */\nimport config from './index'\n\nlet emojiBaseUrl = `http://yx-web.nosdn.127.net/webdoc/h5/emoji`\n\nlet emojiList = {\n  \"emoji\": {\n    \"[大笑]\":{file:\"emoji_0.png\"},\"[可爱]\":{file:\"emoji_01.png\"},\"[色]\":{file:\"emoji_02.png\"},\"[嘘]\":{file:\"emoji_03.png\"},\"[亲]\":{file:\"emoji_04.png\"},\"[呆]\":{file:\"emoji_05.png\"},\"[口水]\":{file:\"emoji_06.png\"},\"[汗]\":{file:\"emoji_145.png\"},\"[呲牙]\":{file:\"emoji_07.png\"},\"[鬼脸]\":{file:\"emoji_08.png\"},\"[害羞]\":{file:\"emoji_09.png\"},\"[偷笑]\":{file:\"emoji_10.png\"},\"[调皮]\":{file:\"emoji_11.png\"},\"[可怜]\":{file:\"emoji_12.png\"},\"[敲]\":{file:\"emoji_13.png\"},\"[惊讶]\":{file:\"emoji_14.png\"},\"[流感]\":{file:\"emoji_15.png\"},\"[委屈]\":{file:\"emoji_16.png\"},\"[流泪]\":{file:\"emoji_17.png\"},\"[嚎哭]\":{file:\"emoji_18.png\"},\"[惊恐]\":{file:\"emoji_19.png\"},\"[怒]\":{file:\"emoji_20.png\"},\"[酷]\":{file:\"emoji_21.png\"},\"[不说]\":{file:\"emoji_22.png\"},\"[鄙视]\":{file:\"emoji_23.png\"},\"[阿弥陀佛]\":{file:\"emoji_24.png\"},\"[奸笑]\":{file:\"emoji_25.png\"},\"[睡着]\":{file:\"emoji_26.png\"},\"[口罩]\":{file:\"emoji_27.png\"},\"[努力]\":{file:\"emoji_28.png\"},\"[抠鼻孔]\":{file:\"emoji_29.png\"},\"[疑问]\":{file:\"emoji_30.png\"},\"[怒骂]\":{file:\"emoji_31.png\"},\"[晕]\":{file:\"emoji_32.png\"},\"[呕吐]\":{file:\"emoji_33.png\"},\"[拜一拜]\":{file:\"emoji_160.png\"},\"[惊喜]\":{file:\"emoji_161.png\"},\"[流汗]\":{file:\"emoji_162.png\"},\"[卖萌]\":{file:\"emoji_163.png\"},\"[默契眨眼]\":{file:\"emoji_164.png\"},\"[烧香拜佛]\":{file:\"emoji_165.png\"},\"[晚安]\":{file:\"emoji_166.png\"},\"[强]\":{file:\"emoji_34.png\"},\"[弱]\":{file:\"emoji_35.png\"},\"[OK]\":{file:\"emoji_36.png\"},\"[拳头]\":{file:\"emoji_37.png\"},\"[胜利]\":{file:\"emoji_38.png\"},\"[鼓掌]\":{file:\"emoji_39.png\"},\"[握手]\":{file:\"emoji_200.png\"},\"[发怒]\":{file:\"emoji_40.png\"},\"[骷髅]\":{file:\"emoji_41.png\"},\"[便便]\":{file:\"emoji_42.png\"},\"[火]\":{file:\"emoji_43.png\"},\"[溜]\":{file:\"emoji_44.png\"},\"[爱心]\":{file:\"emoji_45.png\"},\"[心碎]\":{file:\"emoji_46.png\"},\"[钟情]\":{file:\"emoji_47.png\"},\"[唇]\":{file:\"emoji_48.png\"},\"[戒指]\":{file:\"emoji_49.png\"},\"[钻石]\":{file:\"emoji_50.png\"},\"[太阳]\":{file:\"emoji_51.png\"},\"[有时晴]\":{file:\"emoji_52.png\"},\"[多云]\":{file:\"emoji_53.png\"},\"[雷]\":{file:\"emoji_54.png\"},\"[雨]\":{file:\"emoji_55.png\"},\"[雪花]\":{file:\"emoji_56.png\"},\"[爱人]\":{file:\"emoji_57.png\"},\"[帽子]\":{file:\"emoji_58.png\"},\"[皇冠]\":{file:\"emoji_59.png\"},\"[篮球]\":{file:\"emoji_60.png\"},\"[足球]\":{file:\"emoji_61.png\"},\"[垒球]\":{file:\"emoji_62.png\"},\"[网球]\":{file:\"emoji_63.png\"},\"[台球]\":{file:\"emoji_64.png\"},\"[咖啡]\":{file:\"emoji_65.png\"},\"[啤酒]\":{file:\"emoji_66.png\"},\"[干杯]\":{file:\"emoji_67.png\"},\"[柠檬汁]\":{file:\"emoji_68.png\"},\"[餐具]\":{file:\"emoji_69.png\"},\"[汉堡]\":{file:\"emoji_70.png\"},\"[鸡腿]\":{file:\"emoji_71.png\"},\"[面条]\":{file:\"emoji_72.png\"},\"[冰淇淋]\":{file:\"emoji_73.png\"},\"[沙冰]\":{file:\"emoji_74.png\"},\"[生日蛋糕]\":{file:\"emoji_75.png\"},\"[蛋糕]\":{file:\"emoji_76.png\"},\"[糖果]\":{file:\"emoji_77.png\"},\"[葡萄]\":{file:\"emoji_78.png\"},\"[西瓜]\":{file:\"emoji_79.png\"},\"[光碟]\":{file:\"emoji_80.png\"},\"[手机]\":{file:\"emoji_81.png\"},\"[电话]\":{file:\"emoji_82.png\"},\"[电视]\":{file:\"emoji_83.png\"},\"[声音开启]\":{file:\"emoji_84.png\"},\"[声音关闭]\":{file:\"emoji_85.png\"},\"[铃铛]\":{file:\"emoji_86.png\"},\"[锁头]\":{file:\"emoji_87.png\"},\"[放大镜]\":{file:\"emoji_88.png\"},\"[灯泡]\":{file:\"emoji_89.png\"},\"[锤头]\":{file:\"emoji_90.png\"},\"[烟]\":{file:\"emoji_91.png\"},\"[炸弹]\":{file:\"emoji_92.png\"},\"[枪]\":{file:\"emoji_93.png\"},\"[刀]\":{file:\"emoji_94.png\"},\"[药]\":{file:\"emoji_95.png\"},\"[打针]\":{file:\"emoji_96.png\"},\"[钱袋]\":{file:\"emoji_97.png\"},\"[钞票]\":{file:\"emoji_98.png\"},\"[银行卡]\":{file:\"emoji_99.png\"},\"[手柄]\":{file:\"emoji_100.png\"},\"[麻将]\":{file:\"emoji_101.png\"},\"[调色板]\":{file:\"emoji_102.png\"},\"[电影]\":{file:\"emoji_103.png\"},\"[麦克风]\":{file:\"emoji_104.png\"},\"[耳机]\":{file:\"emoji_105.png\"},\"[音乐]\":{file:\"emoji_106.png\"},\"[吉他]\":{file:\"emoji_107.png\"},\"[火箭]\":{file:\"emoji_108.png\"},\"[飞机]\":{file:\"emoji_109.png\"},\"[火车]\":{file:\"emoji_110.png\"},\"[公交]\":{file:\"emoji_111.png\"},\"[轿车]\":{file:\"emoji_112.png\"},\"[出租车]\":{file:\"emoji_113.png\"},\"[警车]\":{file:\"emoji_114.png\"},\"[自行车]\":{file:\"emoji_115.png\"}\n  }\n}\n\nfor (let emoji in emojiList) {\n  let emojiItem = emojiList[emoji]\n  for (let key in emojiItem) {\n    let item = emojiItem[key]\n    item.img = `${emojiBaseUrl}/${emoji}/${item.file}`\n  }\n}\n\nlet pinupList = {\n  'ajmd':{},\n  'xxy': {},\n  'lt': {}\n}\n\nfor (let i = 1; i <= 48; i++) {\n  let key = 'ajmd0'+ (i >= 10 ? i: '0' + i)\n  pinupList['ajmd'][key] = {file: key + '.png'}\n}\nfor (let i = 1; i <= 40; i++) {\n  let key = 'xxy0'+ (i >= 10 ? i: '0' + i)\n  pinupList['xxy'][key] = {file: key + '.png'}\n}\nfor (let i = 1; i <= 20; i++) {\n  let key = 'lt0'+ (i >= 10 ? i: '0' + i)\n  pinupList['lt'][key] = {file: key + '.png'}\n}\n\nfor (let emoji in pinupList) {\n  let emojiItem = pinupList[emoji]\n  for (let key in emojiItem) {\n    let item = emojiItem[key]\n    item.img = `${emojiBaseUrl}/${emoji}/${item.file}`\n  }\n}\n\nexport default {\n  emojiList,\n  pinupList\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/im/configs/emoji.js","<template>\n  <li class=\"u-msg\"\n    :class=\"{\n      'item-me': msg.flow==='out',\n      'item-you': msg.flow==='in',\n      'item-time': msg.type==='timeTag',\n      'item-tip': msg.type==='tip',\n      'session-chat': type==='session'\n    }\">\n    <div v-if=\"msg.type==='timeTag'\">---- {{msg.showText}} ----</div>\n    <div v-else-if=\"msg.type==='tip'\" class=\"tip\">{{msg.showText}}</div>\n    <div\n      v-else-if=\"msg.flow==='in' || msg.flow==='out'\"\n      :idClient=\"msg.idClient\"\n      :time=\"msg.time\"\n      :flow=\"msg.flow\"\n    >\n      <a class=\"msg-head\" v-if=\"msg.avatar\" :href=\"msg.link\"><img :src=\"msg.avatar\"></a>\n      <p class=\"msg-user\" v-else-if=\"msg.type!=='notification'\"><em>{{msg.showTime}}</em>{{msg.from}}</p>\n\n      <span v-if=\"msg.type==='text'\" class=\"msg-text\" v-html=\"msg.showText\"></span>\n      <span v-else-if=\"msg.type==='custom-type1'\" class=\"msg-text\" ref=\"mediaMsg\"></span>\n      <span v-else-if=\"msg.type==='custom-type3'\" class=\"msg-text\" ref=\"mediaMsg\"></span>\n      <span v-else-if=\"msg.type==='image'\" class=\"msg-text\" ref=\"mediaMsg\" @click.stop=\"showFullImg(msg.originLink)\"></span>\n      <span v-else-if=\"msg.type==='video'\" class=\"msg-text\" ref=\"mediaMsg\"></span>\n      <span v-else-if=\"msg.type==='audio'\" class=\"msg-text\" @click=\"playAudio(msg.audioSrc)\">{{msg.showText}}</span>\n      <span v-else-if=\"msg.type==='file'\" class=\"msg-text\"><a :href=\"msg.fileLink\" target=\"_blank\"><i class=\"u-icon icon-file\"></i>{{msg.showText}}</a></span>\n      <span class=\"msg-text notify\" v-else-if=\"msg.type==='notification'\">{{msg.showText}}</span>\n      <span class=\"msg-text\" v-else v-html=\"msg.showText\"></span>\n      <span v-if=\"msg.status==='fail'\" class=\"msg-failed\"><i class=\"weui-icon-warn\"></i></span>\n    </div>\n  </li>\n</template>\n\n<script type=\"text/javascript\">\n  /*eslint-disable*/\n\n  import util from '../utils'\n  import config from '../configs'\n  import emojiObj from '../configs/emoji'\n\n  export default {\n    props: {\n      type: String, // 类型，chatroom, session\n      rawMsg: {\n        type: Object,\n        default () {\n          return {}\n        }\n      },\n      userInfos: {\n        type: Object,\n        default () {\n          return {}\n        }\n      },\n      myInfo: {\n        type: Object,\n        default () {\n          return {}\n        }\n      }\n    },\n    data () {\n      return {\n        msg: '',\n        isFullImgShow: false,\n        currentAudio: null\n      }\n    },\n    beforeMount () {\n      let item = Object.assign({}, this.rawMsg)\n      // 标记用户，区分聊天室、普通消息\n      if (this.type === 'session') {\n        if (item.flow === 'in') {\n          if (item.from !== this.$store.state.userUID) {\n            item.avatar = this.userInfos[item.from].avatar\n          } else {\n            item.avatar = this.myInfo.avatar\n          }\n          item.link = `#/im_web/namecard/${item.from}`\n        } else if (item.flow === 'out') {\n          item.avatar = this.myInfo.avatar\n        }\n      } else {\n        // 标记时间，聊天室中\n        item.showTime = util.formatDate(item.time)\n      }\n      if (item.type === 'timeTag') {\n        // 标记发送的时间\n        item.showText = item.text\n      } else if (item.type === 'text') {\n        // 文本消息\n        item.showText = util.escape(item.text)\n        if (/\\[[^\\]]+\\]/.test(item.showText)) {\n          let emojiItems = item.showText.match(/\\[[^\\]]+\\]/g)\n          emojiItems.forEach(text => {\n            let emojiCnt = emojiObj.emojiList.emoji\n            if (emojiCnt[text]) {\n              item.showText = item.showText.replace(text, `<img class=\"emoji-small\" src=\"${emojiCnt[text].img}\">`)\n            }\n          })\n        }\n      } else if (item.type === 'custom') {\n        let content = JSON.parse(item.content)\n        // type 1 为猜拳消息\n        if (content.type === 1) {\n          let data = content.data\n          let resourceUrl = config.resourceUrl\n          // item.showText = `<img class=\"emoji-middle\" src=\"${resourceUrl}/im/play-${data.value}.png\">`\n          item.type = 'custom-type1'\n          item.imgUrl = `${resourceUrl}/im/play-${data.value}.png`\n        // type 3 为贴图表情\n        } else if (content.type === 3) {\n          let data = content.data\n          let emojiCnt = ''\n          if (emojiObj.pinupList[data.catalog]) {\n            emojiCnt = emojiObj.pinupList[data.catalog][data.chartlet]\n            // item.showText = `<img class=\"emoji-big\" src=\"${emojiCnt.img}\">`\n            item.type = 'custom-type3'\n            item.imgUrl = `${emojiCnt.img}`\n          }\n        } else {\n          item.showText = util.parseCustomMsg(item)\n          if (item.showText !== '[自定义消息]') {\n            item.showText += ',请到手机或电脑客户端查看'\n          }\n        }\n      } else if (item.type === 'image') {\n        // 原始图片全屏显示\n        item.originLink = item.file.url\n      } else if (item.type === 'video') {\n        // ...\n      } else if (item.type === 'audio') {\n        item.audioSrc = item.file.mp3Url\n        item.showText = Math.round(item.file.dur / 1000) + '\" 点击播放'\n      } else if (item.type === 'file') {\n        item.fileLink = item.file.url\n        item.showText = item.file.name\n      } else if (item.type === 'notification') {\n        //对于系统通知，更新下用户信息的状态\n        item.showText = util.generateChatroomSysMsg(item)\n      } else if (item.type === 'tip') {\n        //对于系统通知，更新下用户信息的状态\n        item.showText = item.tip\n      } else {\n        item.showText = `[${util.mapMsgType(item)}],请到手机或电脑客户端查看`\n      }\n      this.msg = item\n    },\n    mounted () {\n      let item = this.msg\n      // 有时序问题的操作\n      this.$nextTick(() => {\n        let media = null\n        if (item.type === 'image') {\n          // 图片消息缩略图\n          media = new Image()\n          media.src = item.file.url + '?imageView&thumbnail=180x0&quality=85'\n        } else if (item.type === 'custom-type1') {\n          // 猜拳消息\n          media = new Image()\n          media.className = 'emoji-middle'\n          media.src = item.imgUrl\n        } else if (item.type === 'custom-type3') {\n          // 贴图表情\n          media = new Image()\n          media.className = 'emoji-big'\n          media.src = item.imgUrl\n        } else if (item.type === 'video') {\n          if (/(mov|mp4|ogg|webm)/i.test(item.file.ext)) {\n            media = document.createElement('video')\n            media.src = item.file.url\n            media.width = 640\n            media.height = 480\n            media.autoStart = false\n            media.preload = 'metadata'\n            media.controls = 'controls'\n          } else {\n            let aLink = document.createElement('a')\n            aLink.href = item.file.url\n            aLink.target = '_blank'\n            aLink.innerHTML = `<i class=\"u-icon icon-file\"></i>${video.name}`\n            this.$refs.mediaMsg.appendChild(aLink)\n          }\n        }\n        if (media) {\n          if (this.$refs.mediaMsg) {\n            this.$refs.mediaMsg.appendChild(media)\n          }\n          media.onload = () => {\n            this.$emit('msg-loaded')\n          }\n          media.onerror = () => {\n            this.$emit('msg-loaded')\n          }\n        } else {\n          this.$emit('msg-loaded')\n        }\n      }) // end this.nextTick\n    },\n    methods: {\n      revocateMsg (vNode) {\n        // 在会话聊天页\n        if (this.$store.state.currSessionId) {\n          if (vNode && vNode.data && vNode.data.attrs) {\n            let attrs = vNode.data.attrs\n            // 自己发的消息\n            if (attrs.flow === 'out') {\n              let that = this\n              this.$vux.confirm.show({\n                title: '确定需要撤回消息',\n                onCancel () {\n                },\n                onConfirm () {\n                  that.$store.dispatch('revocateMsg', {\n                    idClient: attrs.idClient\n                  })\n                }\n              })\n            }\n          }\n        }\n      },\n      showFullImg (src) {\n        this.$store.dispatch('showFullscreenImg', {\n          src\n        })\n      },\n      playAudio (src) {\n        if (!this.currentAudio) {\n          this.currentAudio = new Audio(src)\n          this.currentAudio.play()\n          this.currentAudio.onended = () => {\n            this.currentAudio = null\n          }\n        }\n      }\n    }\n  }\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/components/im/components/ChatItem.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('li',{staticClass:\"u-msg\",class:{\n    'item-me': _vm.msg.flow==='out',\n    'item-you': _vm.msg.flow==='in',\n    'item-time': _vm.msg.type==='timeTag',\n    'item-tip': _vm.msg.type==='tip',\n    'session-chat': _vm.type==='session'\n  }},[(_vm.msg.type==='timeTag')?_c('div',[_vm._v(\"---- \"+_vm._s(_vm.msg.showText)+\" ----\")]):(_vm.msg.type==='tip')?_c('div',{staticClass:\"tip\"},[_vm._v(_vm._s(_vm.msg.showText))]):(_vm.msg.flow==='in' || _vm.msg.flow==='out')?_c('div',{attrs:{\"idClient\":_vm.msg.idClient,\"time\":_vm.msg.time,\"flow\":_vm.msg.flow}},[(_vm.msg.avatar)?_c('a',{staticClass:\"msg-head\",attrs:{\"href\":_vm.msg.link}},[_c('img',{attrs:{\"src\":_vm.msg.avatar}})]):(_vm.msg.type!=='notification')?_c('p',{staticClass:\"msg-user\"},[_c('em',[_vm._v(_vm._s(_vm.msg.showTime))]),_vm._v(_vm._s(_vm.msg.from))]):_vm._e(),_vm._v(\" \"),(_vm.msg.type==='text')?_c('span',{staticClass:\"msg-text\",domProps:{\"innerHTML\":_vm._s(_vm.msg.showText)}}):(_vm.msg.type==='custom-type1')?_c('span',{ref:\"mediaMsg\",staticClass:\"msg-text\"}):(_vm.msg.type==='custom-type3')?_c('span',{ref:\"mediaMsg\",staticClass:\"msg-text\"}):(_vm.msg.type==='image')?_c('span',{ref:\"mediaMsg\",staticClass:\"msg-text\",on:{\"click\":function($event){$event.stopPropagation();_vm.showFullImg(_vm.msg.originLink)}}}):(_vm.msg.type==='video')?_c('span',{ref:\"mediaMsg\",staticClass:\"msg-text\"}):(_vm.msg.type==='audio')?_c('span',{staticClass:\"msg-text\",on:{\"click\":function($event){_vm.playAudio(_vm.msg.audioSrc)}}},[_vm._v(_vm._s(_vm.msg.showText))]):(_vm.msg.type==='file')?_c('span',{staticClass:\"msg-text\"},[_c('a',{attrs:{\"href\":_vm.msg.fileLink,\"target\":\"_blank\"}},[_c('i',{staticClass:\"u-icon icon-file\"}),_vm._v(_vm._s(_vm.msg.showText))])]):(_vm.msg.type==='notification')?_c('span',{staticClass:\"msg-text notify\"},[_vm._v(_vm._s(_vm.msg.showText))]):_c('span',{staticClass:\"msg-text\",domProps:{\"innerHTML\":_vm._s(_vm.msg.showText)}}),_vm._v(\" \"),(_vm.msg.status==='fail')?_c('span',{staticClass:\"msg-failed\"},[_c('i',{staticClass:\"weui-icon-warn\"})]):_vm._e()]):_vm._e()])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1b0ae6db\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/im/components/ChatItem.vue\n// module id = null\n// module chunks = ","<template>\n  <ul id=\"chat-list\" class=\"m-chat-list p-chat-list\" style=\"padding-bottom:40px;margin-top:40px\">\n    <li class=\"u-msg item-time\" v-if=\"canLoadMore\">\n\n    </li>\n    <li class=\"u-msg item-time\" v-else>\n  \n    </li>\n    <chat-item\n      v-for=\"msg in msglist\"\n      :type=\"type\"\n      :rawMsg=\"msg\"\n      :userInfos=\"userInfos\"\n      :myInfo=\"myInfo\"\n      :key=\"msg.idClient\"\n      @msg-loaded=\"msgLoaded\"\n    ></chat-item>\n  </ul>\n</template>\n<script type=\"text/javascript\">\n  /*eslint-disable*/\n\n  import util from '../utils'\n  import config from '../configs'\n  import emojiObj from '../configs/emoji'\n  import ChatItem from './ChatItem'\n\n  export default {\n    components: {\n      ChatItem\n    },\n    props: {\n      type: String, // 类型，chatroom, session\n      canLoadMore: [String, Boolean],\n      msglist: {\n        type: Array,\n        default () {\n          return []\n        }\n      },\n      userInfos: {\n        type: Object,\n        default () {\n          return {}\n        }\n      },\n      myInfo: {\n        type: Object,\n        default () {\n          return {}\n        }\n      }\n    },\n    data () {\n      return {\n        isFullImgShow: false,\n        msgLoadedTimer: null\n      }\n    },\n    methods: {\n      showFullImg (src) {\n        this.$store.dispatch('showFullscreenImg', {\n          src\n        })\n      },\n      msgLoaded () {\n        clearTimeout(this.msgLoadedTimer)\n        this.msgLoadedTimer = setTimeout(() => {\n          this.$emit('msgs-loaded')\n        }, 20)\n      }\n    }\n  }\n</script>\n\n<style type=\"scss\">\n  /* #chat-list{\n    height: 580px;\n  } */\n\n  .p-chat-list {\n    .u-icon {\n      width: 1.4rem;\n      height: 1.6rem;\n      margin-right: 0.2rem;\n      vertical-align: bottom;\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/im/components/ChatList.vue","var normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatItem.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatItem.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1b0ae6db\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./ChatItem.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/im/components/ChatItem.vue\n// module id = null\n// module chunks = ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ul',{staticClass:\"m-chat-list p-chat-list\",staticStyle:{\"padding-bottom\":\"40px\",\"margin-top\":\"40px\"},attrs:{\"id\":\"chat-list\"}},[(_vm.canLoadMore)?_c('li',{staticClass:\"u-msg item-time\"}):_c('li',{staticClass:\"u-msg item-time\"}),_vm._v(\" \"),_vm._l((_vm.msglist),function(msg){return _c('chat-item',{key:msg.idClient,attrs:{\"type\":_vm.type,\"rawMsg\":msg,\"userInfos\":_vm.userInfos,\"myInfo\":_vm.myInfo},on:{\"msg-loaded\":_vm.msgLoaded}})})],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-3b3d0edf\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/im/components/ChatList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-3b3d0edf\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ChatList.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3b3d0edf\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./ChatList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/im/components/ChatList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}